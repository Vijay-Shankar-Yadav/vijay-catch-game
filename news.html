<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mahmmadpur Ke Mathiya News</title>
<style>
body { font-family: Arial, sans-serif; margin:0; background:#e0f7ff; color:#333; }
header { background: linear-gradient(135deg,#3a7bd5,#00d2ff); color:white; text-align:center; padding:2rem 1rem;}
header h1 { margin:0; font-size:2rem; }
nav { background:#004aad; text-align:center; padding:0.5rem; }
nav a { color:white; text-decoration:none; margin:0 10px; font-weight:bold; }
nav a:hover { text-decoration:underline; }
.container { max-width:900px; margin:2rem auto; padding:1rem; background:white; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
.container img, .container video { width:100%; border-radius:10px; margin-top:10px; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
.like-section { margin-top:10px; display:flex; align-items:center; gap:10px; }
.like-section button { background:#00d2ff; border:none; padding:8px 14px; color:white; border-radius:5px; cursor:pointer; font-weight:bold; }
.like-section button:hover { background:#3a7bd5; transform:scale(1.05); }
.comment-section { margin-top:20px; border-top:1px solid #ddd; padding-top:10px;}
.comment-section input, .comment-section textarea { width:100%; margin-bottom:8px; padding:8px; border:1px solid #ccc; border-radius:6px; }
.comment-btn { background:#4CAF50; color:white; padding:8px 12px; border:none; border-radius:5px; cursor:pointer; }
.comment-btn:hover { background:#45a049; }
.comment { background:#f8f8f8; margin-top:8px; padding:6px 10px; border-radius:5px; }
footer { text-align:center; padding:1rem; background:#004aad; color:white; margin-top:2rem;}
</style>
</head>
<body>

<header>
  <h1>üì∞ Mahmmadpur Ke Mathiya News</h1>
</header>

<nav>
  <a href="index.html">Home</a>
  <a href="contact.html">Contact</a>
</nav>

<div id="newsContainer"></div>

<footer>
  <p>¬© 2025 Mahmmadpur Ke Mathiya ‚Äî All Rights Reserved.</p>
</footer>

<script>
const BACKEND_URL = "https://backendgame-0nir.onrender.com";
const container = document.getElementById("newsContainer");

async function loadNews() {
  const res = await fetch(`${BACKEND_URL}/news`);
  const data = await res.json();
  container.innerHTML = "";

  data.forEach(news => {
    const newsDiv = document.createElement("div");
    newsDiv.className = "container";

    let mediaHTML = "";
    if(news.image) mediaHTML += `<img src="${news.image}" alt="${news.title}">`;
    if(news.video) mediaHTML += `<video controls><source src="${news.video}" type="video/mp4"></video>`;

    newsDiv.innerHTML = `
      <h2>${news.title}</h2>
      <p>${news.content}</p>
      ${mediaHTML}
      <div class="like-section">
        <button onclick="likeNews('${news._id}', this)">üëç Like</button>
        <span>${news.likes}</span> Likes
      </div>
      <div class="comment-section">
        <input type="text" placeholder="Your Name" id="name-${news._id}">
        <textarea placeholder="Your Comment" id="comment-${news._id}"></textarea>
        <button class="comment-btn" onclick="addComment('${news._id}')">Post Comment</button>
        <div id="comments-${news._id}"></div>
      </div>
    `;

    const commentsDiv = newsDiv.querySelector(`#comments-${news._id}`);
    news.comments.forEach(c => {
      const div = document.createElement("div");
      div.className = "comment";
      div.innerHTML = `<strong>${c.name}</strong>: ${c.text}`;
      commentsDiv.appendChild(div);
    });

    container.appendChild(newsDiv);
  });
}

async function likeNews(id, btn) {
  const res = await fetch(`${BACKEND_URL}/news/${id}/like`, { method: "POST" });
  const data = await res.json();
  btn.nextElementSibling.innerText = data.likes;
}

async function addComment(id) {
  const name = document.getElementById(`name-${id}`).value.trim();
  const text = document.getElementById(`comment-${id}`).value.trim();
  if(!name || !text) return alert("Enter name and comment!");

  const res = await fetch(`${BACKEND_URL}/news/${id}/comment`, {
    method:"POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, text })
  });
  const comments = await res.json();

  const commentsDiv = document.getElementById(`comments-${id}`);
  commentsDiv.innerHTML = "";
  comments.forEach(c => {
    const div = document.createElement("div");
    div.className = "comment";
    div.innerHTML = `<strong>${c.name}</strong>: ${c.text}`;
    commentsDiv.appendChild(div);
  });

  document.getElementById(`name-${id}`).value = "";
  document.getElementById(`comment-${id}`).value = "";
}

loadNews();
</script>

</body>
</html>
